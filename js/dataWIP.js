var _ = require('underscore-node');

// objets JSON obtenus depuis des CSV avec d3.csv
var pays_enfants = [{"1996":"","1997":"1","1998":"6","1999":"6","2000":"26","2001":"18","2002":"16","2003":"17","2004":"22","2005":"18","2006":"11","2007":"9","2008":"49","2009":"22","2010":"22","2011":"11","2012":"9","pays":"Mali","id":"466","Total":"263"},{"1996":"","1997":"","1998":"8","1999":"8","2000":"8","2001":"5","2002":"16","2003":"15","2004":"17","2005":"8","2006":"10","2007":"16","2008":"8","2009":"3","2010":"3","2011":"6","2012":"9","pays":"Algérie","id":"12","Total":"140"},{"1996":"","1997":"","1998":"","1999":"","2000":"2","2001":"2","2002":"4","2003":"6","2004":"5","2005":"8","2006":"7","2007":"5","2008":"8","2009":"4","2010":"26","2011":"31","2012":"29","pays":"Sénégal","id":"686","Total":"137"},{"1996":"","1997":"1","1998":"1","1999":"6","2000":"5","2001":"4","2002":"5","2003":"7","2004":"7","2005":"4","2006":"3","2007":"7","2008":"9","2009":"12","2010":"19","2011":"14","2012":"18","pays":"Madagascar","id":"450","Total":"122"},{"1996":"","1997":"2","1998":"2","1999":"1","2000":"2","2001":"","2002":"4","2003":"5","2004":"5","2005":"7","2006":"12","2007":"4","2008":"15","2009":"9","2010":"11","2011":"9","2012":"17","pays":"Cameroun","id":"120","Total":"105"},{"1996":"","1997":"","1998":"1","1999":"3","2000":"6","2001":"7","2002":"8","2003":"5","2004":"14","2005":"8","2006":"8","2007":"5","2008":"3","2009":"5","2010":"5","2011":"6","2012":"5","pays":"Maroc","id":"504","Total":"89"},{"1996":"","1997":"","1998":"","1999":"","2000":"1","2001":"","2002":"","2003":"6","2004":"8","2005":"2","2006":"4","2007":"11","2008":"12","2009":"10","2010":"15","2011":"4","2012":"5","pays":"Congo","id":"178","Total":"78"},{"1996":"","1997":"","1998":"1","1999":"1","2000":"1","2001":"","2002":"1","2003":"","2004":"6","2005":"8","2006":"5","2007":"5","2008":"4","2009":"3","2010":"7","2011":"16","2012":"1","pays":"Burkina Faso","id":"854","Total":"59"},{"1996":"","1997":"","1998":"","1999":"1","2000":"1","2001":"","2002":"3","2003":"7","2004":"9","2005":"2","2006":"1","2007":"1","2008":"4","2009":"1","2010":"5","2011":"14","2012":"15","pays":"RDC","id":"180","Total":"64"},{"1996":"","1997":"","1998":"","1999":"2","2000":"2","2001":"4","2002":"1","2003":"3","2004":"1","2005":"2","2006":"1","2007":"9","2008":"6","2009":"3","2010":"4","2011":"1","2012":"10","pays":"Côte d'Ivoire","id":"384","Total":"49"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"18","2004":"11","2005":"7","2006":"5","2007":"6","2008":"1","2009":"","2010":"","2011":"","2012":"","pays":"Angola","id":"24","Total":"48"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"1","2002":"2","2003":"2","2004":"3","2005":"6","2006":"3","2007":"3","2008":"3","2009":"","2010":"2","2011":"10","2012":"5","pays":"Niger","id":"562","Total":"40"},{"1996":"","1997":"","1998":"","1999":"1","2000":"1","2001":"4","2002":"1","2003":"","2004":"2","2005":"3","2006":"1","2007":"1","2008":"","2009":"1","2010":"6","2011":"4","2012":"14","pays":"Burundi","id":"108","Total":"39"},{"1996":"","1997":"1","1998":"5","1999":"1","2000":"","2001":"","2002":"4","2003":"5","2004":"3","2005":"3","2006":"5","2007":"2","2008":"","2009":"1","2010":"","2011":"","2012":"1","pays":"Egypte","id":"818","Total":"31"},{"1996":"","1997":"","1998":"","1999":"1","2000":"1","2001":"","2002":"","2003":"","2004":"","2005":"1","2006":"2","2007":"1","2008":"4","2009":"5","2010":"6","2011":"2","2012":"5","pays":"Guinée","id":"324","Total":"28"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"1","2004":"","2005":"","2006":"","2007":"","2008":"1","2009":"2","2010":"2","2011":"4","2012":"14","pays":"Benin","id":"204","Total":"24"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"1","2002":"","2003":"5","2004":"","2005":"2","2006":"1","2007":"1","2008":"2","2009":"1","2010":"1","2011":"6","2012":"4","pays":"Gabon","id":"266","Total":"24"},{"1996":"","1997":"","1998":"2","1999":"1","2000":"2","2001":"3","2002":"3","2003":"4","2004":"1","2005":"","2006":"1","2007":"","2008":"","2009":"1","2010":"","2011":"","2012":"","pays":"Mauritanie","id":"478","Total":"18"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"1","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"4","2011":"5","2012":"2","pays":"Djibouti","id":"262","Total":"12"},{"1996":"","1997":"","1998":"","1999":"1","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"1","2010":"","2011":"2","2012":"3","pays":"Comores","id":"174","Total":"7"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"2","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"4","pays":"Togo","id":"768","Total":"6"},{"1996":"","1997":"","1998":"","1999":"1","2000":"","2001":"","2002":"","2003":"1","2004":"1","2005":"","2006":"","2007":"","2008":"","2009":"1","2010":"","2011":"","2012":"1","pays":"Tchad","id":"148","Total":"5"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"1","2005":"","2006":"1","2007":"1","2008":"","2009":"1","2010":"","2011":"","2012":"","pays":"Centre Afrique","id":"140","Total":"4"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"1","2004":"1","2005":"","2006":"1","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Rwanda","id":"646","Total":"3"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"1","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"1","2009":"","2010":"","2011":"1","2012":"","pays":"Yemen","id":"887","Total":"3"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"2","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Cap Vert","id":"132","Total":"2"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"1","2009":"1","2010":"","2011":"","2012":"","pays":"Gambie","id":"270","Total":"2"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"2","pays":"Nigeria","id":"566","Total":"2"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"1","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Ethiopie","id":"231","Total":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"1","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Sierra Léone","id":"694","Total":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"1","2012":"","pays":"Soudan","id":"729","Total":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"1","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Zimbabwe","id":"716","Total":"1"},{"1996":"","1997":"","1998":"","1999":"5","2000":"9","2001":"15","2002":"13","2003":"15","2004":"25","2005":"15","2006":"11","2007":"15","2008":"11","2009":"6","2010":"9","2011":"3","2012":"8","pays":"Laos","id":"418","Total":"160"},{"1996":"","1997":"","1998":"","1999":"2","2000":"6","2001":"11","2002":"5","2003":"","2004":"3","2005":"","2006":"4","2007":"4","2008":"","2009":"1","2010":"1","2011":"","2012":"","pays":"Vietnam","id":"704","Total":"37"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"1","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"1","2009":"2","2010":"7","2011":"","2012":"","pays":"Cambodge","id":"116","Total":"11"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"2","2007":"3","2008":"1","2009":"","2010":"","2011":"","2012":"","pays":"Mongolie","id":"496","Total":"6"},{"1996":"","1997":"","1998":"","1999":"","2000":"1","2001":"","2002":"1","2003":"","2004":"1","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Chine","id":"156","Total":"3"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"1","2003":"","2004":"1","2005":"","2006":"1","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Kirghistan","id":"417","Total":"3"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"2","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Tonga","id":"776","Total":"2"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"2","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Vanuatu","id":"548","Total":"2"},{"1996":"","1997":"1","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Inde","id":"356","Total":"1"},{"1996":"","1997":"1","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Russie","id":"643","Total":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"1","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Samoa","id":"882","Total":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"1","2009":"","2010":"","2011":"","2012":"","pays":"Ouzbekistan","id":"860","Total":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"1","2011":"","2012":"","pays":"Arménie","id":"51","Total":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"1","pays":"Tadjikistan","id":"762","Total":"1"},{"1996":"","1997":"5","1998":"7","1999":"7","2000":"8","2001":"11","2002":"6","2003":"16","2004":"20","2005":"13","2006":"1","2007":"10","2008":"1","2009":"9","2010":"12","2011":"15","2012":"10","pays":"Syrie","id":"760","Total":"151"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"3","2004":"","2005":"1","2006":"","2007":"2","2008":"9","2009":"13","2010":"6","2011":"10","2012":"1","pays":"Irak","id":"368","Total":"45"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"2","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Pakistan","id":"586","Total":"2"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"1","2005":"1","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Afghanistan","id":"4","Total":"2"},{"1996":"","1997":"","1998":"","1999":"","2000":"1","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Liban","id":"422","Total":"1"},{"1996":"10","1997":"25","1998":"14","1999":"9","2000":"8","2001":"15","2002":"18","2003":"10","2004":"","2005":"1","2006":"1","2007":"","2008":"1","2009":"1","2010":"","2011":"","2012":"","pays":"Moldavie","id":"498","Total":"113"},{"1996":"","1997":"7","1998":"4","1999":"","2000":"","2001":"1","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Ukraine","id":"804","Total":"12"},{"1996":"1","1997":"","1998":"1","1999":"","2000":"","2001":"1","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Roumanie","id":"642","Total":"3"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"1","2002":"","2003":"","2004":"","2005":"1","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Kosovo","id":"-3","Total":"2"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"1","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Bosnie","id":"70","Total":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"2","2001":"","2002":"","2003":"1","2004":"1","2005":"","2006":"","2007":"","2008":"2","2009":"","2010":"","2011":"","2012":"2","pays":"Haïti","id":"332","Total":"8"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"3","2009":"1","2010":"","2011":"1","2012":"","pays":"Rép. Dominicaine","id":"214","Total":"5"},{"1996":"","1997":"","1998":"1","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"Cuba","id":"192","Total":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"1","2010":"","2011":"","2012":"","pays":"Sainte-Lucie","id":"662","Total":"1"}] 
var pays_missions = [{"2008":"1","2009":"","2010":"","2011":"","2012":"","pays":"Cameroun","id":"120"},{"2008":"","2009":"1","2010":"","2011":"","2012":"","pays":"Congo Brazzaville","id":"178"},{"2008":"","2009":"1","2010":"1","2011":"","2012":"","pays":"Syrie","id":"760"},{"2008":"","2009":"1","2010":"","2011":"","2012":"","pays":"Senegal","id":"686"},{"2008":"","2009":"","2010":"1","2011":"","2012":"","pays":"Niger","id":"562"},{"2008":"","2009":"","2010":"1","2011":"","2012":"","pays":"Gabon","id":"266"},{"2008":"","2009":"","2010":"1","2011":"","2012":"","pays":"Burkina Faso","id":"854"},{"2008":"","2009":"","2010":"","2011":"1","2012":"","pays":"Djibouti","id":"262"},{"2008":"","2009":"","2010":"","2011":"1","2012":"","pays":"RDC","id":"180"},{"2008":"","2009":"","2010":"","2011":"1","2012":"","pays":"Benin","id":"204"},{"2008":"","2009":"","2010":"","2011":"1","2012":"","pays":"Madagascar","id":"450"},{"2008":"","2009":"","2010":"","2011":"","2012":"1","pays":"Togo","id":"768"},{"2008":"","2009":"","2010":"","2011":"","2012":"1","pays":"Burundi","id":"108"},{"2008":"","2009":"","2010":"","2011":"","2012":"1","pays":"Gambie","id":"270"}]
var pays_formations = [{"2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"1","pays":"ALGERIE","id":"12","total":"1"},{"2006":"1","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"ANGOLA","id":"24","total":"1"},{"2006":"","2007":"","2008":"1","2009":"","2010":"2","2011":"","2012":"1","pays":"BENIN","id":"204","total":"4"},{"2006":"1","2007":"","2008":"","2009":"1","2010":"1","2011":"","2012":"1","pays":"BURKINA FASO","id":"854","total":"4"},{"2006":"1","2007":"","2008":"","2009":"","2010":"1","2011":"","2012":"","pays":"BURUNDI","id":"108","total":"2"},{"2006":"","2007":"","2008":"1","2009":"","2010":"","2011":"","2012":"","pays":"CAMBODGE","id":"116","total":"1"},{"2006":"2","2007":"","2008":"","2009":"1","2010":"2","2011":"1","2012":"","pays":"CAMEROUN","id":"120","total":"6"},{"2006":"","2007":"1","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"CAP VERT","id":"132","total":"1"},{"2006":"","2007":"","2008":"1","2009":"","2010":"","2011":"1","2012":"","pays":"COMORES","id":"174","total":"2"},{"2006":"1","2007":"","2008":"","2009":"","2010":"1","2011":"","2012":"","pays":"CONGO BRAZZAVILLE","id":"178","total":"2"},{"2006":"","2007":"","2008":"","2009":"1","2010":"","2011":"","2012":"","pays":"COTE D'IVOIRE","id":"384","total":"1"},{"2006":"","2007":"","2008":"","2009":"","2010":"1","2011":"","2012":"","pays":"DJIBOUTI","id":"262","total":"1"},{"2006":"","2007":"1","2008":"","2009":"1","2010":"1","2011":"1","2012":"1","pays":"GABON","id":"266","total":"5"},{"2006":"","2007":"1","2008":"1","2009":"","2010":"","2011":"","2012":"","pays":"GUINEE","id":"324","total":"2"},{"2006":"","2007":"1","2008":"","2009":"","2010":"","2011":"1","2012":"","pays":"HAITI","id":"332","total":"2"},{"2006":"1","2007":"1","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"LAOS","id":"418","total":"2"},{"2006":"1","2007":"2","2008":"","2009":"2","2010":"","2011":"","2012":"1","pays":"MADAGASCAR","id":"450","total":"6"},{"2006":"","2007":"1","2008":"","2009":"1","2010":"1","2011":"","2012":"","pays":"MALI","id":"466","total":"3"},{"2006":"","2007":"","2008":"2","2009":"","2010":"","2011":"2","2012":"1","pays":"MAROC","id":"504","total":"5"},{"2006":"1","2007":"","2008":"","2009":"1","2010":"","2011":"","2012":"","pays":"MAURITANIE","id":"478","total":"2"},{"2006":"1","2007":"","2008":"1","2009":"1","2010":"","2011":"","2012":"2","pays":"NIGER","id":"562","total":"5"},{"2006":"","2007":"1","2008":"","2009":"","2010":"","2011":"1","2012":"1","pays":"REP CENTRAFRICAINE","id":"140","total":"3"},{"2006":"1","2007":"","2008":"","2009":"1","2010":"1","2011":"1","2012":"1","pays":"REP DEMOCRATIQUE CONGO","id":"180","total":"5"},{"2006":"","2007":"1","2008":"","2009":"","2010":"","2011":"","2012":"","pays":"REP DOMINICAINE","id":"214","total":"1"},{"2006":"","2007":"1","2008":"1","2009":"2","2010":"","2011":"1","2012":"1","pays":"SENEGAL","id":"686","total":"6"},{"2006":"","2007":"","2008":"","2009":"","2010":"","2011":"1","2012":"","pays":"TCHAD","id":"148","total":"1"},{"2006":"","2007":"","2008":"1","2009":"","2010":"1","2011":"1","2012":"1","pays":"TOGO","id":"768","total":"4"},{"2006":"","2007":"","2008":"2","2009":"","2010":"","2011":"","2012":"","pays":"VIETNAM","id":"704","total":"2"}] 
var sites_enfants = [{"1996":"","1997":"","1998":"","1999":"12","2000":"88","2001":"103","2002":"107","2003":"131","2004":"90","2005":"76","2006":"38","2007":"","2008":"1","2009":"3","2010":"1","2011":"","2012":"","id":"NE","code":"NECKER","Hopital":"Hôpital Necker","Ville":"Paris","lat":"48.844871","lng":"2.314746","(vide)":"","Total général":"650"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"2","2005":"","2006":"","2007":"2","2008":"11","2009":"2","2010":"5","2011":"3","2012":"4","id":"AN","code":"ANGERS","Hopital":"ANGERS","Ville":"Angers","lat":"47.4784190","lng":"-0.563166","(vide)":"","Total général":"29"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"3","2006":"9","2007":"10","2008":"14","2009":"9","2010":"12","2011":"9","2012":"10","id":"BO","code":"BORDEAUX","Hopital":"BORDEAUX","Ville":"Bordeaux","lat":"44.8377890","lng":"-0.579180","(vide)":"","Total général":"76"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"16","2006":"20","2007":"29","2008":"25","2009":"5","2010":"17","2011":"30","2012":"40","id":"ML","code":"CCML","Hopital":"Centre Chirurgical Marie Lannelongue","Ville":"Le Plessis-Robinson","lat":"48.784332","lng":"2.273709","(vide)":"","Total général":"182"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"8","2007":"29","2008":"42","2009":"19","2010":"34","2011":"33","2012":"27","id":"GP","code":"HEGP","Hopital":"Hôpital Européen Georges Pompidou","Ville":"Paris","lat":"48.83882","lng":"2.273183","(vide)":"","Total général":"192"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"1","2009":"","2010":"","2011":"","2012":"","id":"PE","code":"Hôp d'instruction des armées Percy","Hopital":"Hôpital d'instruction des armées Percy","Ville":"Clamart","lat":"48.814438","lng":"2.257004","(vide)":"","Total général":"1"},{"1996":"11","1997":"44","1998":"53","1999":"44","2000":"1","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"","id":"LA","code":"Laennec","Hopital":"Hôpital Laennec","Ville":"Paris","lat":"48.849739","lng":"2.321747","(vide)":"","Total général":"153"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"13","2008":"13","2009":"8","2010":"12","2011":"10","2012":"7","id":"LY","code":"LYON","Hopital":"LYON","Ville":"Lyon","lat":"45.7640430","lng":"4.8356590","(vide)":"","Total général":"63"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"3","2008":"4","2009":"","2010":"7","2011":"9","2012":"9","id":"MA","code":"MARSEILLE","Hopital":"MARSEILLE","Ville":"Marseille","lat":"43.2964820","lng":"5.369780","(vide)":"","Total général":"32"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"1","2006":"","2007":"","2008":"","2009":"9","2010":"46","2011":"55","2012":"69","id":"MY","code":"MASSY","Hopital":"Hôpital Privé Jacques Cartier","Ville":"Massy","lat":"48.731427","lng":"2.291873","(vide)":"","Total général":"180"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"1","2004":"28","2005":"10","2006":"9","2007":"9","2008":"","2009":"","2010":"","2011":"","2012":"","id":"MS","code":"MONTSOURIS","Hopital":"Institut Mutualiste Montsouris","Ville":"Paris","lat":"48.822618","lng":"2.333028","(vide)":"","Total général":"57"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"1","2005":"","2006":"","2007":"","2008":"11","2009":"9","2010":"13","2011":"8","2012":"9","id":"NA","code":"NANTES","Hopital":"NANTES","Ville":"Nantes","lat":"47.217819","lng":"-1.553793","(vide)":"","Total général":"51"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"1","2010":"","2011":"","2012":"","id":"PS","code":"PITIE SALPETRIERE","Hopital":"Hôpital de la Pitié-Salpétrière","Ville":"Paris","lat":"48.838382","lng":"2.361031","(vide)":"","Total général":"1"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"1","2003":"2","2004":"14","2005":"7","2006":"5","2007":"4","2008":"11","2009":"11","2010":"6","2011":"4","2012":"1","id":"SJ","code":"SAINT JOSEPH","Hopital":"Hôpital Saint-Joseph","Ville":"Paris","lat":"48.830254","lng":"2.311152","(vide)":"","Total général":"66"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"","2009":"","2010":"","2011":"","2012":"3","id":"ST","code":"STRASBOURG","Hopital":"STRASBOURG","Ville":"Strasbourg","lat":"48.5831480","lng":"7.7478820","(vide)":"","Total général":"3"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"8","2008":"1","2009":"3","2010":"","2011":"2","2012":"8","id":"TL","code":"TOULOUSE","Hopital":"TOULOUSE","Ville":"Toulouse","lat":"43.6046520","lng":"1.4442090","(vide)":"","Total général":"22"},{"1996":"","1997":"","1998":"","1999":"","2000":"","2001":"","2002":"","2003":"","2004":"","2005":"","2006":"","2007":"","2008":"9","2009":"14","2010":"17","2011":"14","2012":"8","id":"TR","code":"TOURS","Hopital":"TOURS","Ville":"Tours","lat":"47.3941440","lng":"0.684840","(vide)":"","Total général":"62"}] 

var data = {};
var countries = {};
var sites = {};
var sites2 = {};

for (var i = 1996; i < 2014; i++){
	var year = String(i);
	data[year] = {
		'countries': [],
		'sites': []
	};
}



pays_enfants.forEach(function(paysObj){
	//{"2012":"9", "pays":"Algérie", "id":"12", "Total":"140"}
	var id = paysObj.id;
	countries[id] = { 'name': paysObj['pays'], 'total': paysObj['Total']};
	_(paysObj).each(function(v, k){
		if (k === 'pays' || k === 'id' || k === 'Total' || v === '') return;
		data[k]['countries'].push({'id': id, 'enfants' : v});
	})
});

pays_missions.forEach(function(obj){
	//{"2012":"","pays":"Cameroun","id":"120"}  // "2012":""
	var obj_id = obj.id;
	_(obj).each(function(v, k){
		if (k === 'pays' || k === 'id' || k === 'Total' || v === '') return;
		var country_existing = false;
		data[k]['countries'].forEach(function(country){
			if (country.id === obj_id) {
				country_existing = true;
				country['missions'] = v;
			}
		});
		if (country_existing === false) {
			data[k]['countries'].push({'id': obj_id, 'missions' : v});
		}
	})
});

pays_formations.forEach(function(obj){
	//{"2012":"9", "pays":"Algérie", "id":"12", "Total":"140"}
	var obj_id = obj.id;
	_(obj).each(function(v, k){
		if (k === 'pays' || k === 'id' || k === 'total' || v === '') return;
		var country_existing = false;
		data[k]['countries'].forEach(function(country){
			if (country.id === obj_id) {
				country_existing = true;
				country['formations'] = v;
			}
		});
		if (country_existing === false) {
			data[k]['countries'].push({'id': obj_id, 'formations' : v});
		}
	})
});

// sites_enfants.forEach(function(site){
// 	//{"1996":"","1997":"","2012":"","id":"NE","code":"NECKER","Hopital":"Hôpital Necker","Ville":"Paris","lat":"48.844871","lng":"2.314746","(vide)":"","Total général":"650"}
// 	var obj_id = site.id;
// 	sites[obj_id] = { 'ville': site['Ville'], 'hopital': site['Hopital'], 'lat': site['lat'], 'lng': site['lng'], 'total': site['total']};
// 	_(site).each(function(v, k){
// 		if (k === '(vide)' || k === 'lng' || k === 'lat' || k === 'code' || k === 'Ville' || k === 'id' || k === 'Total général' || k === 'Hopital' || v === '') return;
// 		data[k]['sites'].push({'id': obj_id, 'enfants' : v});
// 	})
// });

sites_enfants.forEach(function(site){
	//{"1996":"","1997":"","2012":"","id":"NE","code":"NECKER","Hopital":"Hôpital Necker","Ville":"Paris","lat":"48.844871","lng":"2.314746","(vide)":"","Total général":"650"}
	var ville = site.Ville;
	sites2[ville] = { 'ville': site['Ville'], 'hopital': site['Hopital'], 'lat': site['lat'], 'lng': site['lng'], 'total': site['total']};
	_(site).each(function(v, k){
		if (k === '(vide)' || k === 'lng' || k === 'lat' || k === 'code' || k === 'Ville' || k === 'id' || k === 'Total général' || k === 'Hopital' || v === '') return;
		if ( data[k]['sites']['ville'] ) data[k]['sites']['enfants'] += v;
		else data[k]['sites'].push({'ville': ville, 'enfants' : v});
	})
});

console.log(JSON.stringify(data));
// console.log(JSON.stringify(countries));
// console.log(JSON.stringify(sites));
// console.log(JSON.stringify(_(sites).map(function(d){return d.hopital})));